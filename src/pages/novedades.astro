---
import { fetchGoogleSheetData } from '../utils/google-sheets';
import Layout from '../layouts/Layout.astro';
import Navbarlight from "@components/navbar/navbarlight.astro";
import Container from "@components/container.astro";
import { marked } from 'marked'; // Asegúrate de que 'marked' esté bien importado

// Obtener los datos de la hoja de Google Sheets
const { novedades } = await fetchGoogleSheetData();
---

<Layout title="Novedades">
  <Navbarlight />

  <!-- Contenedor principal -->
  <div class="w-full mt-10">
    <h1 class="text-4xl font-bold text-center mb-6">Listado de Novedades</h1>

    <Container>
      <!-- Iterar sobre las novedades -->
      {novedades.map((novedad, index) => {
        const titulo = novedad[0];
        const descripcion = novedad[1];
        const imagen = novedad[2];
        const fecha = novedad[3];
        const link = `/novedad/${index}`; // Ruta dinámica basada en el índice

        return (
          <div key={index} class="flex items-center mb-6 bg-white rounded-lg shadow-md overflow-hidden">
            <!-- Primera columna: Imagen -->
            <a href={link} class="w-1/4">
              <img 
                src={imagen} 
                alt={titulo} 
                class="object-cover w-full h-full" 
              />
            </a>

            <!-- Segunda columna: Título, descripción y fecha -->
            <div class="w-2/4 px-6 flex flex-col">
              <h2 class="text-2xl font-semibold text-blue-600 mb-2">
                <a href={link}>{titulo}</a>
              </h2>
              <p class="text-gray-700 mb-2">{descripcion}</p>
              <p class="text-sm text-gray-500">{fecha}</p>
            </div>

            <!-- Tercera columna: Botón -->
            <div class="w-1/4 flex justify-center">
              <a 
                href={link} 
                class="bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"
              >
                Ver
              </a>
            </div>
          </div>
        );
      })}
    </Container>
  </div>
</Layout>
